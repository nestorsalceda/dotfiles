#!/bin/zsh

function create_symlinks() {
	symlinks=(vimrc gvimrc gitconfig hgrc)
	for symlink in $symlinks; do
		echo "Creating symlink to ~/.$symlink"
		ln -sf $PWD/$symlink ~/.$symlink
	done
}

function clone_or_upgrade_repository() {
	repository=$1
	destination=$2
	if [[ ! -d $destination ]]; then
		git clone $repository $destination
	else
		pushd $destination
		git pull
		popd
	fi
}

function install_or_upgrade_vundle() {
	clone_or_upgrade_repository https://github.com/gmarik/vundle.git ~/.vim/bundle/vundle
	vim -c "BundleInstall!" -c ":q!" -c ":q!"
}

function install_or_upgrade_oh_my_zsh() {
	oh_my_zsh_dir=~/.oh-my-zsh
	clone_or_upgrade_repository https://github.com/robbyrussell/oh-my-zsh.git $oh_my_zsh_dir
	ln -sf $PWD/zsh/zshrc ~/.zshrc
	ln -sf $PWD/zsh/nestor_salceda.zsh-theme $oh_my_zsh_dir/themes/nestor_salceda.zsh-theme
	ln -sf $PWD/zsh/virtualenvwrapper.zsh $oh_my_zsh_dir/custom/virtualenvwrapper.zsh
	ln -sf $PWD/zsh/rvm.zsh $oh_my_zsh_dir/custom/rvm.zsh
	install_or_upgrade_zsh_syntax_highlighting
}

function install_or_upgrade_zsh_syntax_highlighting() {
	oh_my_zsh_dir=~/.oh-my-zsh
	clone_or_upgrade_repository git://github.com/zsh-users/zsh-syntax-highlighting.git $oh_my_zsh_dir/custom/plugins/zsh-syntax-highlighting
}

function install_or_upgrade_patched_fonts() {
	clone_or_upgrade_repository git://gist.github.com/1630581.git ~/.fonts/ttf-dejavu-powerline
}

create_symlinks
install_or_upgrade_patched_fonts
install_or_upgrade_vundle
install_or_upgrade_oh_my_zsh
